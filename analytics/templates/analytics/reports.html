{% extends "base.html" %}
{% include "header.html" %}
{% block menu %}
  {% include "menu.html" %}
{% endblock menu %}
{% block main-content %}
{% load humanize %}
{% load static %}
<script src="{% static "analytics/js/analyticsapp.js" %}"></script>
<script type="text/javascript" src="{% static "doit/js/datatables.min.js" %}"></script>
<link rel="stylesheet" type="text/css" href="{% static "doit/css/datatables.min.css" %}"/>
<link rel="stylesheet" type="text/css" href="{% static "doit/css/uikitdatatables.css" %}" rel="stylesheet">


<!-- Begin page content -->
<div class="uk-padding-small">

  <div class="uk-child-width-1-4@m uk-grid-small uk-grid-match" uk-grid>
    <div>
        <div class="uk-card uk-card-default uk-card-body">
            <h3 class="uk-card-title">All cards</h3>
            <p>{{allCards.count}}</p>
        </div>
    </div>
    <div>
        <div class="uk-card uk-card-default uk-card-body">
            <h3 class="uk-card-title">Primary</h3>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>
        </div>
    </div>
    <div>
        <div class="uk-card uk-card-default uk-card-body">
            <h3 class="uk-card-title">Teriary</h3>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>
        </div>
    </div>
    <div>
        <div class="uk-card uk-card-default uk-card-body">
            <h3 class="uk-card-title">Secondary</h3>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit.</p>
        </div>
    </div>
</div>

  <!-- reporting -->
  <div class="uk-container">
    <div class="uk-container">
      <div class="uk-section">
          <form action="" method="post">{% csrf_token %}

            <select name="organization" class="uk-form-control uk-input" >
              <option value="">-- Organization --</option>
              {%  for org in organizations %}
                  <option {% if org.name == organization.name %} selected="selected" {% endif %} value="{{ org.id }}">{{ org }}</option>
              {% endfor %}
              </select>

            <select name="user" class="uk-form-control input-sm uk-input" >
            <option value="">-- User --</option>
            {%  for user in reportusers %}
                <option value="{{ user.id }}">{{ user }}</option>
            {% endfor %}
            </select>


            <div class="col-md-3">
                    <input class="uk-input" type="text" name="daterange">
            </div>
            <div class="col-md-3">
              <input type="submit" class="uk-button" value="Generate" />
            </div>
          </form>
      </div>
    </div>
  </div>

  {%  if organization.name %}
  <p class="uk-text-lead">Reporting on {{ organization.name }} for the period {{ reportperiod }}</p>
  {% else %}
  <p class="uk-text-lead">Report for the period {{ reportperiod }}</p>
  {% endif %}
  <div class="uk-section uk-padding-remove-top">
    <div class="uk-padding-small">
        <table id="reports" class="uk-table uk-table-striped uk-table-hover uk-border-rounded" width="100%">
            <thead>
                <tr>
                    <th>Organization</th>
                    <th>Card</th>
                    <th>Card Owner</th>
                    <th>Worklog</th>
                    <th>Priority</th>
                    <th>Status</th>
                    <th>Worklog Owner</th>
                    <th>Worklog Created Time</th>
                    <th>Card Created Time</th>
                    <th>Card Last Modified Time</th>
                    <th>Minutes</th>
                    <th>Overtime</th>
                    <th>Billable</th>
                </tr>
            </thead>
            <tbody>
                {% for i in reportresult %}
                <tr>
                    <td>{{ i.content_object.company }}</td>
                    <td><a href="/cards/editcard/{{i.content_object.id}}">{{i.content_object.id}}</a> - {{ i.content_object.title }}</td>
                    <td>{{ i.content_object.owner }}</td>
                    <td>{{ i|striptags}}</td>
                    <td>{{ i.content_object.priority}}</td>
                    <td>{{ i.content_object.column}}</td>
                    <td>{{ i.owner }}</td>
                    <td>{{ i.created_time }}</td>
                    <td>{{ i.content_object.created_time }}</td>
                    <td>{{ i.content_object.modified_time }}</td>
                    <td>{{ i.minutes }}</td>
                    <td>{{ i.overtime }}</td>
                    <td>{{ i.billable }}</td>
                </tr>
                {%  endfor %}
            </tbody>
        </table>
        <br >
        <table class="uk-table uk-table-striped uk-table-hover" >
            <tr>
                <th>Total minutes (overtime+normal)</th>
                <th>Total overtime minutes</th>
                <th>Total normal minutes</th>
                <th>Non-billable minutes</th>
            </tr>
            <tr style="background-color: lightblue;">
                <td colspan=""><strong>Total minutes:</strong> {{ totalminutes.minutes__sum }}</td>
                <td colspan=""><strong>Working:</strong> {{ totalworkingminutes.minutes__sum }}</td>
                <td colspan=""><strong>Overtime:</strong> {{ totalovertimeminutes.minutes__sum }}</td>
                <td colspan=""><strong>Non-billable:</strong> {{ nonbillable.minutes__sum }}</td>
            </tr>
        </table>
    </div>
    <!-- end reporting -->
  </div>
</div> <!-- end container -->







{% endblock main-content %}

{% block footer %}
 {% include "footer.html" %}
{% endblock footer %}
